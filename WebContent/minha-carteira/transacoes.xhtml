<?xml version='1.0' encoding='UTF-8' ?>
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:p="http://primefaces.org/ui"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core" template="masterPage.xhtml">
	<ui:define name="tituloPagina">Transações</ui:define>
	<ui:define name="conteudo">

		<h:form id="formPesquisaContas">
			<p:panel style="height:100%">
				<p:panel style="height:100%">
					<p:outputLabel value="Transações"
						style="font-size: 250%; vertical-align: middle;"></p:outputLabel>
					<br />

					<p:separator />
					<br />
					
					<p:outputLabel for="dataInicial" value="Data Inicio" />
	        		<p:calendar id="dataInicial"
	        					pattern="dd/MM/yyyy" 
	        					value="#{transacaoController.dtIni}"
	        					showOn="button" />
					<p:outputLabel for="dataFim" value="Data Fim" />
	        		<p:calendar id="dataFim"
	        					pattern="dd/MM/yyyy" 
	        					value="#{transacaoController.dtFim}"
	        					showOn="button" />
	        					

					<p:outputLabel for="conta" value="Conta: " />

					<p:selectOneMenu id="conta"
							 data-classe="ContaDAO"
							 converter="genericConverter"
							 required="true"
							 value="#{transacaoController.contaSelecionada}">
							 <f:selectItem itemLabel="Selecione uma Conta" noSelectionOption="true" itemValue=""/>
							 <f:selectItems
								value="#{transacaoController.listaConta}"
								var="item"
								itemLabel="#{item.descricao}"
								itemValue="#{item}" />
					</p:selectOneMenu>


					<p:commandButton id="buttonSearch" style="width: 100%;"
						 action="#{transacaoController.filtrar}" value="Buscar"
						 icon="fa fa-search">
					 </p:commandButton>

					<p:commandButton id="botaoAdicionar" update=":formDetalhesConta"
							onclick="PF('dlgDetalheConta').show();" style="width:250px"
							icon="fa fa-plus" value="Adicionar Transação">
						<f:setPropertyActionListener value="#{contaController.novaConta}"
							target="#{contaController.contaSelecionada}" />
					</p:commandButton>

					<p:spacer height="30px"></p:spacer>

					<p:messages id="messages" showDetail="false" />

				</p:panel>
				<p:spacer height="30px"></p:spacer>
				<p:dataTable id="idContaDataTable" var="transacao"
					value="#{transacaoController.listaTransacao}" paginator="true"
					rowsPerPageTemplate="5,10,15"
					emptyMessage="Não foi encontrado nenhuma transação.">

					<p:column headerText="Valor">
						<h:outputText value="#{transacao.valor}">
						</h:outputText>
					</p:column>

					<p:column headerText="Alterar" style="width:10%">
						<p:commandButton id="botaoAlterar" update=":formDetalhesConta"
							onclick="PF('dlgDetalheConta').show();" style="width:80px"
							icon="fa fa-pencil">
							<f:setPropertyActionListener value="#{transacao}"
								target="#{transacaoController.transacaoSelecionada}" />
						</p:commandButton>
					</p:column>
				</p:dataTable>
			</p:panel>
		</h:form>
		
		<p:dialog header="Transação" resizable="false" widgetVar="dlgDetalheConta" modal="true" height="400" width="500">
   			<h:form id="formDetalhesConta">

				<p:commandButton id="button" style="width: 100%;"
						 action="#{contaController.salvarConta}" value="Salvar Conta"
						 icon="fa fa-save" />
   			</h:form>
		</p:dialog>

	</ui:define>

</ui:composition>
